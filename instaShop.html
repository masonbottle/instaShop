<!-- This implementation is a NOT DRY FIRST VERSION -->
<!-- This implementat needs a major refactoring to make it configurable from 'customize theme' -->
<!-- Its a good example if you want an example of how to use the shopify buy button on a grid plus carrousell -->

<!-- Gets pictures to use in the Grid and carrousell assign to variables -->
{% capture instaShop_img_1 %}1-instaShop-silicone-nipples.jpg{% endcapture %}
{% capture instaShop_img_2 %}2-instaShop-sleeves.jpg{% endcapture %}
{% capture instaShop_img_3 %}3-instaShop-giftset.jpg{% endcapture %}
{% capture instaShop_img_4 %}4-instaShop-diy.jpg{% endcapture %}
{% capture instaShop_img_5 %}5-instaShop-original-baby-bottle.jpg{% endcapture %}
{% capture instaShop_img_6 %}6-instaShop-giftset.jpg{% endcapture %}
{% capture instaShop_img_7 %}7-instaShop-infant-nipple.jpg{% endcapture %}
{% capture instaShop_img_8 %}11-instaShop-tt.jpg{% endcapture %}
{% capture instaShop_img_9 %}9-instaShop-sleeves.jpg{% endcapture %}

<!-- Assigns urls to variables to be used by add to cart button -->
{% assign diy_url     = "https://masonbottle.com/products/copy-of-mason-bottle-accessory-kit-silicone-sleeve-and-plastic-cap" %}
{% assign nipples_url = "https://masonbottle.com/products/two-pack-of-mason-bottle-silicone-nipples" %}
{% assign og_url      = "https://masonbottle.com/products/mason-bottle" %}
{% assign sleeves_url = "https://masonbottle.com/products/mason-bottle-silicone-sleeve-1" %}
{% assign cap_url     = "https://masonbottle.com/products/mason-bottle-plastic-cap-1" %}
{% assign primi_url   = "https://masonbottle.com/products/mason-bottle-extra-soft-infant-nipple" %}
{% assign tt_url      = "https://masonbottle.com/products/mason-bottle-toddler-tumbler" %}
{% assign gitset_url  = "https://masonbottle.com/products/the-essential-mason-bottle-gift-set" %}





<!-- Instagram Grid -->
<br>
<br>
<br>

<!-- Section Title -->
<div class="section-header text-center">
  <h1>{{ 'Shop Our Instagram ' }}</h1>
  <hr class="hr--small">
</div>

<!-- div to break .wrapper class so grid can go full-width -->
<!-- </div> -->

<br>
<br>

<!-- TODO: turn this section into a dinamically created and configurable HTML -->
<div class="grid blog-grid" align="center">

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_1 | asset_url }}" class="" data-qv-product="nipples" data-fancybox="product-card" data-qv-id="qv-1">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_1 | asset_url }}');"></figure>
    		</a>
      </div>

      <form id="qv-1-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-7d0544eab6d' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ nipples_url }}" class="btn buy-button__mb">ADD TO CART</a>
          </div>
          <div class="product-desc">
            <p>@faustisland just bought a pack of Mason Bottle Silicone Nipples, and then combined one with a classic blue mason jar she had at home. Extra adorable!</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_2 | asset_url }}" data-qv-product="sleeves" class="" data-fancybox="product-card" data-qv-id="qv-2">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_2 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-2-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-cc79cfd62db' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ sleeves_url }}" class="btn buy-button__mb">ADD TO CART</a>
          </div>
          <div class="product-desc">
            <p>@valeryphalon.photography uses Mason Bottle Silicone Sleeves to make toddler training cups for her big girls.</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_3 | asset_url }}" data-qv-product="diy" class="" data-fancybox="product-card" data-qv-id="qv-3">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_3 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-3-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-2a28c446ccf' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ diy_url }}" class="btn buy-button__mb">ADD TO CART</a>
          </div>
          <div class="product-desc">
            <p>@headygrimm gets a Mason Bottle + Silicone Sleeve ready for her little one. She got the whole bottle including the jar as part of the Essential Mason Bottle Gift Set, but you can also make your own with jars from home using the Mason Bottle DIY Kit.</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_4 | asset_url }}" data-qv-product="diy" class="" data-fancybox="product-card" data-qv-id="qv-4">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_4 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-4-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-2a28c446ccf' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ diy_url }}" class="btn buy-button__mb">ADD TO CART</a>
          </div>
          <div class="product-desc">
            <p>@loveandcovenant uses the 8 oz DIY Kit in combination with their mason jars from home.</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_5 | asset_url }}" data-qv-product="bottles" class="" data-fancybox="product-card" data-qv-id="qv-5">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_5 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-5-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-0d78551ee26' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ og_url }}" class="btn buy-button__mb">ADD TO CART</a>
          </div>
          <div class="product-desc">
            <p>@eyecreate_ gave her little lade The Original Mason Bottle. The width of mason jars makes them easy to hold for little hands.</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_6 | asset_url }}" data-qv-product="giftset" class="" data-fancybox="product-card" data-qv-id="qv-6">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_6 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-6-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-a214ab1f17a' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ gifset_url }}" class="btn buy-button__mb">PRE ORDER</a>
          </div>
          <div class="product-desc">
            <p>@headygrimm got the Essential Mason Bottle Gift Set for her little one. It comes with both size bottles, both sleeves, and set of extra set of Medium Flow Nipples.</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_7 | asset_url }}" data-qv-product="softNips" class="" data-fancybox="product-card" data-qv-id="qv-7">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_7 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-7-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-b8d3858a0b5' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ primi_url }}" class="btn buy-button__mb">ADD TO CART</a>
          </div>
          <div class="product-desc">
            <p>Paola used Mason Bottle with her son Max from the day they brought him home from the NICU. Though he didn't take to the preemie nipples in the hospital, he latched onto his Mason Bottle immediately!</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_8 | asset_url }}" data-qv-product="tt" class="" data-fancybox="product-card" data-qv-id="qv-8">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_8 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-8-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-d8e6678d6ad' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ tt_url }}" class="btn buy-button__mb">PRE ORDER</a>
          </div>
          <div class="product-desc">
            <p>Checkout the 4-in-1 design of the Toddler Tumbler.</p>
          </div>
        </div>
      </form>
    </div>

    <div class="grid__item large--one-third medium--one-whole">
      <div class="fig-bin">
        <a href="{{instaShop_img_9 | asset_url }}" data-qv-product="sleeves" class="" data-fancybox="product-card" data-qv-id="qv-9">
          <figure class="fig-tile" style="background-image: url('{{instaShop_img_9 | asset_url }}');"></figure>
        </a>
      </div>

      <form id="qv-9-form" class="product-form" action="">
        <div class="grid">
          <div class="buy-button" id='product-component-cc79cfd62db' style="margin: 0 auto;">
            <div class="fancybox-loading"></div>
          </div>
          <div align="center">
            <a href="{{ sleeves_url }}" class="btn buy-button__mb">ADD TO CART</a>
          </div>
          <div class="product-desc">
            <p>@MasonBottle we like to use our 4 oz. sleeves with baby food portions.</p>
          </div>
        </div>
      </form>
    </div>

</div>
<br>

<!-- Reopen .wrapper after full-width grid -->
<!-- <div class="wrapper"> -->


<script type="text/javascript">
// ============================================================================
//                           InstaShop Widget
// ----------------------------------------------------------------------------
function instaShop() {

  // Mobile layout configuration
  function twoColumnsInstaShop(){
    $('.buy-button').addClass("grid__item large--one-half medium--one-half small--one-half");
    $('.product-desc').addClass("grid__item large--one-half medium--one-half small--one-half");
  }

  // Changes layout for mobile and desktop
  $( window ).resize(function() {
    if($(window).innerWidth() <= 590) {
      twoColumnsInstaShop()
    }else{
      $('.buy-button').removeClass("grid__item large--one-half medium--one-half small--one-half");
      $('.product-desc').removeClass("grid__item large--one-half medium--one-half small--one-half");
    }
  });


  var buyButtonOptions = {
    "product": {
      "variantId": "all",
      "width": "240px",
      "contents": {
        "imgWithCarousel": false,
        "variantTitle": false,
        "description": false,
        "buttonWithQuantity": false,
        "quantity": false
      },
      "events": {
        "afterRender": function (component) {$('.product-desc').show();},
      },
      "styles": {
        "product": {
          "@media (min-width: 601px)": {
            "max-width": "100%",
            "margin-left": "0",
            "margin-bottom": "50px"
          }
        },
        "button": {
          "display": "none",
          "background-color": "#5cb8b2",
          ":hover": {
            "background-color": "#53a6a0"
          },
          ":focus": {
            "background-color": "#53a6a0"
          }
        },
        "compareAt": {
          "font-size": "12px"
        }
      }
    },
    "cart": {
      "contents": {
        "button": false
      },
      "styles": {
        "button": {
          "background-color": "#5cb8b2",
          ":hover": {
            "background-color": "#53a6a0"
          },
          ":focus": {
            "background-color": "#53a6a0"
          }
        },
        "footer": {
          "background-color": "#ffffff"
        }
      }
    },
    "modalProduct": {
      "contents": {
        "img": false,
        "imgWithCarousel": true,
        "variantTitle": false,
        "buttonWithQuantity": false,
        "button": false,
        "quantity": false
      },
      "styles": {
        "product": {
          "@media (min-width: 601px)": {
            "max-width": "100%",
            "margin-left": "0px",
            "margin-bottom": "0px"
          }
        },
        "button": {
          "background-color": "#5cb8b2",
          ":hover": {
            "background-color": "#53a6a0"
          },
          ":focus": {
            "background-color": "#53a6a0"
          }
        }
      }
    },
    "toggle": {
      "styles": {
        "toggle": {
          "background-color": "#5cb8b2",
          ":hover": {
            "background-color": "#53a6a0"
          },
          ":focus": {
            "background-color": "#53a6a0"
          }
        }
      }
    },
    "productSet": {
      "styles": {
        "products": {
          "@media (min-width: 601px)": {
            "margin-left": "-20px"
          }
        }
      }
    }
  };

  var configSet = {
    'nipples': {  divId        : 'product-component-7d0544eab6d',
                  componentId  : 4488305348
    },
    'diy'    : {  divId        : 'product-component-2a28c446ccf',
                  componentId  : 4488688708
    },
    'sleeves': {  divId        : 'product-component-cc79cfd62db',
                  componentId  : 4554100100
    },
    'bottles': {  divId        : 'product-component-0d78551ee26',
                  componentId  : 1854786436
    },
    'giftset': {  divId        : 'product-component-a214ab1f17a',
                  componentId  : 9362413060
    },
    'caps'  : {   divId        : 'product-component-2329ef42626',
                  componentId  : 6309363908
    },
    'softNips': { divId        : 'product-component-b8d3858a0b5',
                  componentId  : 6246253828
    },
    'tt'      : { divId        : 'product-component-d8e6678d6ad',
                  componentId  : 11460169732
    }
  };

  function ShopifyBuyInit(config) {
    var client = ShopifyBuy.buildClient({
      domain: 'mason-bottle.myshopify.com',
      apiKey: 'YOURKEY',
      appId: '6',
    });

    ShopifyBuy.UI.onReady(client).then(function (ui) {
      var $node = document.getElementById(config.divId);
      $($node).empty();
      ui.createComponent('product', {
        id: [config.componentId],
        node: $node,
        moneyFormat: '%24%7B%7Bamount%7D%7D',
        options: buyButtonOptions
      });
    });
  };

  $('[data-fancybox="product-card"]').fancybox({
      // Disable zooming
      animationEffect : "fade",

  		// Change gallery item transition effect
  		transitionEffect : 'slide',

  		// Disable unnecessary modules
  		thumbs     : false,
  		fullScreen : false,
  		slideShow  : false,

  		// Disable idle
  		idleTime : false,

      // Disable vertical dragging
  		touch : {
         vertical : false
  		},

  		// Add custom class to container
  		baseClass  : 'qv-container',

      // Loop carrousell
      loop : true,

  		// Add form inside modal
      beforeShow : function(instance, current, firstRun) {

        // Remove any previously created form
        $("#qv-form-clone").remove();

        // Get current product id
        var $element  = current.opts.$orig;
        var qvID      = $element.data('qv-id');
        var productId = $element.data('qv-product');

        // Find product form
        var $qvForm  = $( '#' + qvID + '-form' );

        // Clone form and add inside modal
        $qvForm.clone( true ).attr('id', 'qv-form-clone').appendTo( instance.$refs.inner ).show();

        // Trigger Shopify Buy Button
        ShopifyBuyInit(configSet[productId]);
        if(window.innerWidth <= 590 ) {
          twoColumnsInstaShop()
        }
  		},
      beforeLoad: function(instance, current, firstRun){
        $('.product-desc').hide();
      },
      mobile : {
          clickContent : function( current, event ) {
              return current.type === 'image' ? false : false;
          },
          clickOutside : function( current, event ) {
              return current.type === 'image' ? 'close' : 'close';
          },
          dblclickContent : function( current, event ) {
              return current.type === 'image' ? false : false;
          }
      },

  });
};

// Execute on Document Ready
$(instaShop)
</script>

<style media="screen">
// InstaShop
/*
Step #1 - Styling the page and item grid
========================================
*/
.fig-bin{
  overflow: hidden;
  margin-bottom: 27px !important;
}

.fig-tile{
  margin: 0px;
  width: 100%;
  background-color: transparent;
  background-size: cover;
  background-position: 50%;
  margin-bottom: 0px;
  padding: 0;
  padding-bottom: 100%;
  margin: 0;
  transition: transform 3.525s ease-out .01s,background-color .725s ease-in-out,opacity 3.525s ease-out;
}

.fig-tile:hover{
  transform: scaleX(1.15) scaleY(1.15) translateZ(0);
}

/*
Step #2 - Styling the modal
===========================
*/

.qv-container .fancybox-inner {
  position: absolute;
  top: 50%;
  left: 50%;
  right: auto;
  bottom: auto;
  transform: translate3d(-50%, -50%, 0);
  width: calc(100% - 40px);
  height: calc(100% - 40px);
  max-width: 980px;
  max-height: 650px;
  z-index: 99994;

  @include at-query($max, $small) {
    width: 100%;
    height: 100%;
  }
}

.qv-container .fancybox-image-wrap {
  @include at-query($max, $small) {
    transform: none !important;
  }
}

.qv-container .fancybox-stage {
  background: #fff;
  left: 0;
  right: 43%;

  @include at-query($max, $small) {
    right: 0%;
  }
}

.qv-container form {
  position: absolute;
  top: 30px;
  right: 0;
  bottom: 30px;
  width: 43.1%;
  background: #fff;
  border-left: 8px solid #f4f4f4;

  @include at-query($max, $small) {
    z-index: 10000000;
    margin-top: 230px;
    width: 100%;
    border-left: 0px solid #e9e9e9;
  }
}

.qv-container .fancybox-toolbar {
  top: 30px;
  transform: translateZ(0);
}

.qv-container .fancybox-button {
  background: #F0F0F0;
  color: #222;
  @include at-query($max, $small) {
    top: -30px;
  }
}

.qv-container .fancybox-button:hover:not([disabled]) {
  background: #E3E3E3;
  color: #000;
}

.fancybox-button--close::before,
.fancybox-button--close::after {
  height: 1px;
  width: 18px;
}

.qv-container .fancybox-arrow--left {
  left: -65px;
}

.qv-container .fancybox-arrow--right {
  right: -65px;
}


/*
Step #3 - Styling product form
==============================
*/

.product-form {
  display: none;
  padding: 20px 40px;
  color: #777;
  box-sizing: border-box;
  overflow: scroll;
}

.product-scroll-area {
  margin-right: -40px;
  margin-left: -40px;
  padding: 0 40px;
  height: calc(100% - 130px);
}

.product-desc{
  text-align: center;
  margin-top: 15px;
  display:none;

  @include at-query($max, $small) {
    font-size: 15px !important;
    margin-top: 17px;
  }

  p {
    word-wrap: break-word;
  }
}

/*
Buy button add to cart replaced by a custom one
==============================================
*/
.buy-button__mb {
  background-color: #5cb8b2;
  color: white;
  border-radius: 5px;
  font-size: 12px;
}
</style>
